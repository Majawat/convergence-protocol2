<!doctype html>
<html lang="en" data-bs-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Convergence Protocol - Quick Reference</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
      rel="stylesheet" />
    <link rel="icon" type="image/x-icon" href="/assets/img/favicons/favicon.ico" />
    <link rel="icon" type="image/png" href="assets/img/favicons/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="assets/img/favicons/favicon.svg" />
    <link rel="shortcut icon" href="assets/img/favicons/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="assets/img/favicons/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="OPR" />
    <link rel="manifest" href="assets/img/favicons/site.webmanifest" />
    <style>
      body {
        font-size: 14px; /* Base size for TV - further condensed */
        overflow: hidden;
        height: 100vh;
        background-color: #212529;
        color: #f8f9fa;
      }
      .main-container {
        height: 100vh;
        max-height: 100vh;
        display: flex;
        flex-direction: column;
      }
      .navbar {
        padding: 0.1rem 0.8rem;
        background-color: #343a40 !important;
        flex-shrink: 0;
      }
      .navbar-brand {
        font-size: 1rem;
      }
      .navbar-brand img {
        height: 20px;
      }
      .reference-content-row {
        flex-grow: 1;
        overflow: hidden;
      }
      .reference-column {
        height: calc(100vh - 38px); /* Approx Navbar height */
        overflow-y: auto;
        padding: 0.3rem;
      }
      .reference-column::-webkit-scrollbar {
        width: 6px;
      }
      .reference-column::-webkit-scrollbar-track {
        background: #2c3034;
      }
      .reference-column::-webkit-scrollbar-thumb {
        background-color: #495057;
        border-radius: 3px;
        border: 1px solid #2c3034;
      }
      .card {
        background-color: #2c3034;
        border: 1px solid #495057;
        margin-bottom: 0.4rem;
      }
      .card-header {
        background-color: #343a40;
        border-bottom: 1px solid #495057;
        padding: 0.25rem 0.4rem;
      }
      .card-body {
        padding: 0.4rem;
      }
      h4.card-title-custom {
        font-size: 1rem;
        font-weight: bold;
        color: #17a2b8;
        border-bottom: 1px solid #343a40;
        padding-bottom: 0.15rem;
        margin-bottom: 0.25rem;
      }
      h5 {
        /* For rule-section titles */
        font-size: 0.85rem;
        font-weight: bold;
        margin-bottom: 0.1rem;
        color: #0dcaf0;
      }
      h6 {
        /* For mission sub-headings */
        font-size: 0.75rem;
        font-weight: bold;
        margin-top: 0.2rem;
        margin-bottom: 0.05rem;
        color: #66d9ff;
      }
      .rule-section {
        /* For core rules text blocks */
        font-size: 0.75rem;
        border-left: 2px solid #0d6efd;
        padding-left: 5px;
        margin-bottom: 0.2rem;
      }
      .table {
        font-size: 0.7rem;
        margin-bottom: 0.2rem;
      }
      .table th,
      .table td {
        padding: 0.1rem 0.2rem;
      }
      .mission-section {
        border-top: 1px solid rgba(255, 255, 255, 0.07);
        padding-top: 0.25rem;
        margin-top: 0.25rem;
      }
      .current-mission-card .card-body {
        font-size: 0.75rem;
      }
      .current-mission-card ul {
        padding-left: 0.7rem;
        margin-bottom: 0.15rem;
      }
      .current-mission-card li {
        margin-bottom: 0.05rem;
        line-height: 1.25;
      }
      strong,
      th {
        color: #e9ecef;
      }
      p {
        margin-bottom: 0.2rem;
        color: #ced4da;
        line-height: 1.25;
      }
      .small-text,
      .current-mission-card .small-text ul li {
        font-size: 0.65rem;
        color: #adb5bd;
        line-height: 1.2;
      }
      .objectives-table td,
      .objectives-table th {
        padding: 0.05rem 0.2rem;
        font-size: 0.65rem;
      }
      ul li ul li {
        font-size: 0.9em;
        line-height: 1.2;
      }
      .campaign-rules-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 0.3rem;
      }
      .campaign-rules-grid .rule-section {
        margin-bottom: 0;
      }

      /* Warrior Unit Card Styles (adapted from example) */
      .warrior-unit-card {
        font-size: 0.7rem; /* Further Compact font for warrior cards */
        border-width: 1px;
        margin-bottom: 0.3rem; /* Reduced margin between cards in the row */
        display: flex; /* Added for flex children */
        flex-direction: column; /* Stack header and body */
        height: 100%; /* Make cards in a row same height */
      }
      .warrior-unit-card .card-header {
        padding: 0.2rem 0.3rem;
        flex-shrink: 0;
      }
      .warrior-unit-card .card-title {
        font-size: 0.8rem;
        margin-bottom: 0.02rem;
      }
      .warrior-unit-card .text-muted {
        font-size: 0.6rem;
      }
      .warrior-unit-card .header-meta-info .info-item {
        font-size: 0.6rem;
        margin-right: 2px;
      }
      .warrior-unit-card .header-meta-info .info-separator {
        display: none;
      }

      .warrior-unit-card .card-body {
        padding: 0.3rem;
        flex-grow: 1; /* Allow body to take available space */
        display: flex;
        flex-direction: column;
      }
      .warrior-unit-card .effective-stats {
        display: flex;
        justify-content: space-around;
        align-items: center;
        margin-bottom: 0.2rem;
        padding: 0.2rem;
        background-color: rgba(0, 0, 0, 0.1);
        border-radius: 0.2rem;
      }
      .warrior-unit-card .stat-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        font-size: 0.65rem;
      }
      .warrior-unit-card .stat-item span {
        font-weight: bold;
        font-size: 0.8rem;
      }
      .warrior-unit-card .stat-icon {
        font-size: 0.9rem;
        margin-bottom: 0.05rem;
      }

      .warrior-unit-card .details-section {
        padding-top: 0.15rem;
        flex-grow: 1; /* Allow details to take space */
      }
      .warrior-unit-card .details-section strong.d-block {
        font-size: 0.7rem;
        margin-bottom: 0.05rem;
      }
      .warrior-unit-card .rules-list-item {
        display: inline-block;
        padding: 0.05em 0.25em;
        margin: 0.05em;
        background-color: #343a40;
        border-radius: 0.15rem;
        font-size: 0.6rem;
      }
      .warrior-unit-card .weapon-table th,
      .warrior-unit-card .weapon-table td {
        padding: 0.05rem 0.15rem;
        font-size: 0.6rem;
      }
      .warrior-unit-card hr.my-1 {
        margin-top: 0.15rem !important;
        margin-bottom: 0.15rem !important;
      }
      .spawned-warriors-row .col-md-4 {
        padding-left: 0.15rem;
        padding-right: 0.15rem;
      }
    </style>
  </head>
  <body>
    <div class="main-container">
      <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
          <a class="navbar-brand" href="#">
            <img src="assets/img/logo.webp" height="50" alt="Logo" class="me-2" />
            The Convergence Protocol - Quick Ref
          </a>
        </div>
      </nav>

      <div class="container-fluid reference-content-row">
        <div class="row h-100 gx-2">
          <div class="col-lg-5 col-md-6 p-2 reference-column">
            <div class="card">
              <div class="card-header">
                <h4 class="mb-0 card-title-custom">Core Rules (GF v3.4.1 Summary)</h4>
              </div>
              <div class="card-body">
                <div class="rule-section">
                  <h5>Activation & Movement</h5>
                  <table class="table table-sm table-dark table-striped">
                    <thead>
                      <tr>
                        <th>Action</th>
                        <th>Move</th>
                        <th>Notes</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>Hold</td>
                        <td>0"</td>
                        <td>Can shoot</td>
                      </tr>
                      <tr>
                        <td>Advance</td>
                        <td>6"</td>
                        <td>Can shoot after move</td>
                      </tr>
                      <tr>
                        <td>Rush</td>
                        <td>12"</td>
                        <td>Can't shoot</td>
                      </tr>
                      <tr>
                        <td>Charge</td>
                        <td>12"</td>
                        <td>To melee, ignore 1" rule</td>
                      </tr>
                    </tbody>
                  </table>
                  <p class="small-text">
                    No 1" proximity (unless charging). No moving through units.
                  </p>
                </div>
                <div class="rule-section">
                  <h5>Shooting</h5>
                  <p>
                    Pick 1 target (or 2 if multi-weapon). Models with LoS & range fire. Sum Attacks.
                    Quality tests for hits. Target Defense tests to block. Remove casualties.
                  </p>
                </div>
                <div class="rule-section">
                  <h5>Melee</h5>
                  <p>
                    Chargers to base contact. Defenders move 3" to engage. Models in 2" horiz / 4"
                    vert strike. Defenders strike back. <br /><strong>Fatigue:</strong> After 1st
                    attack (charge/strike back), hits on 6s in melee this round.
                  </p>
                </div>
                <div class="rule-section">
                  <h5>Morale</h5>
                  <p>
                    If unit &lt;= half models/Tough OR loses melee: Quality test. Fail = Shaken.<br /><strong
                      >Shaken:</strong
                    >
                    Idle, Fatigued, auto-fail Morale, no objectives. Idle to recover.<br /><strong
                      >Routed (Melee Loss at &lt;= Half Str):</strong
                    >
                    Unit removed.
                  </p>
                </div>
                <div class="rule-section">
                  <h5>Terrain</h5>
                  <p>
                    <strong>Cover:</strong> +1 Def vs Shoot. <strong>Difficult:</strong> Max move
                    6". <strong>Dangerous:</strong> Test on entry/activation; '1' = 1 wound.
                  </p>
                </div>
              </div>
            </div>

            <div class="card mt-2">
              <div class="card-header">
                <h4 class="mb-0 card-title-custom">Campaign Rules Summary (v3.4.0)</h4>
              </div>
              <div class="card-body campaign-rules-grid p-2">
                <div class="rule-section"><strong>Events:</strong> Start of round, D6: 5+</div>
                <div class="rule-section">
                  <strong>Goals:</strong> Win: 2VP, 150pts. Lose: 300pts.
                </div>
                <div class="rule-section">
                  <strong>Spec. Obj.:</strong> +75pts.
                  <ol
                    class="small-text ps-3 mb-0"
                    style="list-style-type: decimal; margin-left: -5px">
                    <li>Mastery</li>
                    <li>Honor</li>
                    <li>Casting</li>
                    <li>Recovery</li>
                    <li>Rage</li>
                    <li>Destruction</li>
                  </ol>
                </div>
                <div class="rule-section">
                  <strong>Casualties:</strong> D6: 1=Dead (H:-5pts,Injury), 2-5=OK, 6=+1XP
                  (H:+5pts,Talent)
                </div>
                <div class="rule-section">
                  <p><strong>XP:</strong> +1 OK; +1 Kill Unit; +2 Kill Hero; +3 Kill Hero+Unit.</p>
                </div>
                <div class="rule-section">
                  <strong>Level Up (5XP):</strong> Reg +25pts, Hero +55pts. Traits.
                </div>
                <div class="rule-section"><strong>Cmd Pts:</strong> D3+3 start.</div>
              </div>
            </div>
          </div>

          <div class="col-lg-7 col-md-6 p-2 reference-column">
            <div class="card current-mission-card">
              <div class="card-header">
                <h4 class="mb-0 card-title-custom">Current Mission: The Siege of the Core (M6)</h4>
              </div>
              <div class="card-body">
                <div class="mission-section pt-0 mt-0">
                  <h6>Teams:</h6>
                  <p class="small-text">
                    <strong>AI-Controlled:</strong> Claire (Hive Fleet Tarvos) + Alex (van Louen's Roughnecks)<br>
                    <strong>Defenders:</strong> Cody (The Ashen Pact) + Victoria (Galdoo'o naahlk wildigitkw)
                  </p>
                </div>
                <div class="mission-section">
                  <h6>Primary Objective:</h6>
                  <p>
                    Standard objective control. Control more objectives than your opponent team at the end of the game to win.
                  </p>
                </div>
                <div class="mission-section">
                  <h6>Deployment:</h6>
                  <p>Teams deploy in opposite table quarters. Place 5 objectives in standard configuration.</p>
                </div>
                <div class="mission-section">
                  <h6>Special Rules:</h6>
                  <ul class="small-text">
                    <li><strong>AI Neural Override:</strong> Claire and Alex are allied and cannot attack each other.</li>
                    <li><strong>Defensive Alliance:</strong> Cody and Victoria are allied and cannot attack each other.</li>
                  </ul>
                </div>
                <div class="mission-section">
                  <h6>Victory:</h6>
                  <p class="small-text">
                    Team controlling most objectives at game end wins.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="card" style="position: fixed; bottom: 10px; right: 10px; z-index: 1000; width: auto; min-width: 140px;">
      <div class="card-body" style="padding: 0.3rem 0.5rem; font-size: 0.7rem;">
        Cody awake for: <span id="wakeTimer">--:--:--</span>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      function updateWakeTimer() {
        const yesterday7am = new Date();
        yesterday7am.setDate(yesterday7am.getDate() - 1);
        yesterday7am.setHours(7, 0, 0, 0);
        
        const now = new Date();
        const diff = now - yesterday7am;
        
        const hours = Math.floor(diff / (1000 * 60 * 60));
        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((diff % (1000 * 60)) / 1000);
        
        document.getElementById('wakeTimer').textContent = 
          `${hours} hours, ${minutes} minutes, ${seconds} seconds`;
      }
      
      updateWakeTimer();
      setInterval(updateWakeTimer, 1000);
    </script>
  </body>
</html>
